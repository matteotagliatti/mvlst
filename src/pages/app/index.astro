---
import Layout from "@/layouts/AppLayout.astro";
import { getMovies } from "@/lib/pocketbase";

const isLogged: boolean = Astro.locals.pb.authStore.isValid;

if (!isLogged) {
  return Astro.redirect("/");
}

const movies = await getMovies(Astro.locals.pb);
---

<Layout title="mvlst">
  <section class="grid grid-cols-2 gap-2">
    {
      movies.map((movie) => {
        return (
          <a
            href={`/app/edit?id=${movie.id}`}
            class="w-fit rounded transition-all hover:-translate-y-1 hover:shadow"
          >
            <img class="rounded" src={movie.poster} alt={movie.title} />
            <p>{movie.title}</p>
          </a>
        );
      })
    }
  </section>
</Layout>
