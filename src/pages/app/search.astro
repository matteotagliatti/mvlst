---
import MovieLink from "@/components/movie-link.astro";
import Button from "@/components/ui/button.astro";
import Layout from "@/layouts/AppLayout.astro";
import { getSearch } from "@/lib/search";

const name = Astro.url.searchParams.get("name");
const movies = await getSearch(name);
---

<Layout title="Search">
  <form action="/app/search" method="get" hx-target="#search">
    <input
      class="rounded border border-black"
      type="text"
      name="name"
      id="name"
      required
      placeholder="test"
    />
    <Button text="Search" />
  </form>
  <section id="search" class="grid grid-cols-2 gap-4">
    {
      movies?.map((movie) => {
        return <MovieLink title={movie.title} poster={movie.poster_path} />;
      })
    }
  </section>
</Layout>
